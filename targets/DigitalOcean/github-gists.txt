https://gist.githubusercontent.com/daniellevy/ba81db12d63c8627cf41e43370262a78/raw/7a010b6ea1fbf00c3744729d6ddaaa5a198d297d/per_elem.py
